# VKR
Постановка задачи 
1.	 Выбрать кейс предметной области.
2.	 Построить пайплайн для сбора, обработки и хранения данных рассматриваемого кейса. Дополнительно может включать техническое проектирование: ERD, формализацию основных бизнес-процессов, описание архитектуры, выбор СУБД и описание схем БД, перечисление  алгоритмов и методов анализа и обработки.   
3.	 Разработать пайплайн ETL процесса, который будет включать в себя работу с различными источниками данных.  Обработанные данные направить в DWH. Предусмотреть  возможность выборки данных для дашбордов.
4.	 Выбрать данные для классификации или прогноза, реализовать модель ML и интегрировать в пайплайн.
5.	 Описать взаимодействие пользователя с разработанной системой. 
6.	 Создать профиль на github.com(или в ином репозитории) и разместить практическую часть работы.

Решение:
1) Выбран кейс по покупке авиабилетов
2) Проведен анализ данных. Выбрано СУБД и произведено деление данных по разным таблицам для упроцения получения данных для анализа. Написан python скрипт booking.py по обработке файла customer_booking.csv с данными. Скипт включает в себя подготовка базы СУБД postgres (создание схемы, таблиц с зависимосятми), обработка данных, валидация и запись в новый источник.
3) Реализован пайплайн Airflow который включает в себя запись данных из postgres в DWH Hive с последующей дополнительными обработками по агрегированим данных для интересующих показателей (предпочтение клинтов, популярные маршруты). Популярные маршруты реализованы с  помощью инструмента spark получая данные из базы postgres, а предпочтения клиетов из файла csv. Агрегированные данные записываются в Hive для последующего использования в дашбордах пользователей. 
4) Была создана регрессивная модель RandomForestRegressor и обучена с использованием показателей weekday, month, flight_duration, flight_distance, num_passengers, weather. Создание и обучение модели внедрено в ETL airflow. 

